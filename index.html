<!DOCTYPE html>
<html>
<head>
    <title>gcSafeMemmove Bug Demonstration</title>
</head>
<body>
<script>
// Function to create a large array and perform backward copy operations
function triggerBug() {
    const arraySize = 1024 * 1024 * 50; // 50 million elements
    let largeArray = new Uint32Array(arraySize);

    // Initialize the array with some data
    for (let i = 0; i < arraySize; i++) {
        largeArray[i] = i;
    }

    // Function to perform backward memmove-like operations
    function backwardCopy(src, dst, length) {
        for (let i = length - 1; i >= 0; i--) {
            dst[i] = src[i];
        }
    }

    // Create source and destination views within the same array to simulate overlapping regions
    let srcView = largeArray.subarray(0, arraySize - 1);
    let dstView = largeArray.subarray(1, arraySize);

    // Perform backward copy operations repeatedly to stress the engine
    for (let i = 0; i < 10; i++) {
        backwardCopy(srcView, dstView, srcView.length);
    }
}

// Run the test and catch any potential errors
try {
    triggerBug();
    console.log('Test completed without triggering the bug.');
} catch (e) {
    console.error('Bug triggered:', e);
    alert('Bug triggered: ' + e);
}
</script>
</body>
</html>

